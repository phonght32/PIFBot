ARM GAS  /tmp/cc757XYJ.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"madgwick.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.invSqrt,"ax",%progbits
  18              		.align	1
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu fpv4-sp-d16
  24              	invSqrt:
  25              	.LFB5:
  26              		.file 1 "/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c"
   1:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** #include "madgwick.h"
   2:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
   3:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** #define MADGWICK_INIT_ERR_STR       "Madgwick AHRS init error"
   4:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
   5:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** static const char* MADGWICK_TAG = "MADGWICK AHRS";
   6:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** #define MADGWICK_CHECK(a, str, ret)  if(!(a)) {                                             \
   7:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         STM_LOGE(MADGWICK_TAG,"%s:%d (%s):%s", __FILE__, __LINE__, __FUNCTION__, str);      \
   8:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         return (ret);                                                                       \
   9:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         }
  10:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
  11:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** /* Mutex define */
  12:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** #define mutex_lock(x)       while (xSemaphoreTake(x, portMAX_DELAY) != pdPASS)
  13:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** #define mutex_unlock(x)     xSemaphoreGive(x)
  14:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** #define mutex_create()      xSemaphoreCreateMutex()
  15:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** #define mutex_destroy(x)    vQueueDelete(x)
  16:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
  17:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
  18:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** typedef struct madgwick {
  19:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float beta;
  20:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float sample_freq;
  21:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float q0;
  22:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float q1;
  23:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float q2;
  24:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float q3; 
  25:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     SemaphoreHandle_t lock;
  26:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** } madgwick_t;
  27:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
  28:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** static float invSqrt(float x)
  29:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** {
  27              		.loc 1 29 0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
ARM GAS  /tmp/cc757XYJ.s 			page 2


  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              		@ link register save eliminated.
  32              	.LVL0:
  30:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float halfx = 0.5f * x;
  33              		.loc 1 30 0
  34 0000 F6EE007A 		vmov.f32	s15, #5.0e-1
  35 0004 60EE277A 		vmul.f32	s15, s0, s15
  36              	.LVL1:
  31:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float y = x;
  32:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     long i = *(long*)&y;
  37              		.loc 1 32 0
  38 0008 10EE102A 		vmov	r2, s0	@ int
  39              	.LVL2:
  33:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     i = 0x5f3759df - (i >> 1);
  34:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     y = *(float*)&i;
  40              		.loc 1 34 0
  41 000c 074B     		ldr	r3, .L2
  42 000e A3EB6203 		sub	r3, r3, r2, asr #1
  43              	.LVL3:
  44 0012 07EE103A 		vmov	s14, r3	@ int
  45              	.LVL4:
  35:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     y = y * (1.5f - (halfx * y * y));
  46              		.loc 1 35 0
  47 0016 67EE877A 		vmul.f32	s15, s15, s14
  48              	.LVL5:
  49 001a 67EE277A 		vmul.f32	s15, s14, s15
  50 001e B7EE080A 		vmov.f32	s0, #1.5e+0
  51              	.LVL6:
  52 0022 30EE670A 		vsub.f32	s0, s0, s15
  53              	.LVL7:
  36:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     return y;
  37:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** }
  54              		.loc 1 37 0
  55 0026 27EE000A 		vmul.f32	s0, s14, s0
  56 002a 7047     		bx	lr
  57              	.L3:
  58              		.align	2
  59              	.L2:
  60 002c DF59375F 		.word	1597463007
  61              		.cfi_endproc
  62              	.LFE5:
  64              		.section	.text.madgwick_config,"ax",%progbits
  65              		.align	1
  66              		.global	madgwick_config
  67              		.syntax unified
  68              		.thumb
  69              		.thumb_func
  70              		.fpu fpv4-sp-d16
  72              	madgwick_config:
  73              	.LFB6:
  38:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
  39:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** madgwick_handle_t madgwick_config(madgwick_config_t *config)
  40:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** {
  74              		.loc 1 40 0
  75              		.cfi_startproc
  76              		@ args = 0, pretend = 0, frame = 0
  77              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/cc757XYJ.s 			page 3


  78              	.LVL8:
  79 0000 30B5     		push	{r4, r5, lr}
  80              	.LCFI0:
  81              		.cfi_def_cfa_offset 12
  82              		.cfi_offset 4, -12
  83              		.cfi_offset 5, -8
  84              		.cfi_offset 14, -4
  85 0002 87B0     		sub	sp, sp, #28
  86              	.LCFI1:
  87              		.cfi_def_cfa_offset 40
  41:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     /* Check input conditions */
  42:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     MADGWICK_CHECK(config, MADGWICK_INIT_ERR_STR, NULL);
  88              		.loc 1 42 0
  89 0004 C0B1     		cbz	r0, .L9
  90 0006 0546     		mov	r5, r0
  43:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
  44:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     /* Allocate memory for handle structure */
  45:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     madgwick_handle_t handle = calloc(1, sizeof(madgwick_t));
  91              		.loc 1 45 0
  92 0008 1C21     		movs	r1, #28
  93 000a 0120     		movs	r0, #1
  94              	.LVL9:
  95 000c FFF7FEFF 		bl	calloc
  96              	.LVL10:
  46:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     MADGWICK_CHECK(handle, MADGWICK_INIT_ERR_STR, NULL);
  97              		.loc 1 46 0
  98 0010 0446     		mov	r4, r0
  99 0012 20B3     		cbz	r0, .L10
  47:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
  48:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     /* Update handle structure */
  49:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->beta = config->beta;
 100              		.loc 1 49 0
 101 0014 2B68     		ldr	r3, [r5]	@ float
 102 0016 0360     		str	r3, [r0]	@ float
  50:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->sample_freq = config->sample_freq;
 103              		.loc 1 50 0
 104 0018 6B68     		ldr	r3, [r5, #4]	@ float
 105 001a 4360     		str	r3, [r0, #4]	@ float
  51:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->q0 = 1.0f;
 106              		.loc 1 51 0
 107 001c 4FF07E53 		mov	r3, #1065353216
 108 0020 8360     		str	r3, [r0, #8]	@ float
  52:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->q1 = 0.0f;
 109              		.loc 1 52 0
 110 0022 0023     		movs	r3, #0
 111 0024 C360     		str	r3, [r0, #12]	@ float
  53:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->q2 = 0.0f;
 112              		.loc 1 53 0
 113 0026 0361     		str	r3, [r0, #16]	@ float
  54:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->q3 = 0.0f;
 114              		.loc 1 54 0
 115 0028 4361     		str	r3, [r0, #20]	@ float
  55:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->lock = mutex_create();
 116              		.loc 1 55 0
 117 002a 0120     		movs	r0, #1
 118              	.LVL11:
 119 002c FFF7FEFF 		bl	xQueueCreateMutex
ARM GAS  /tmp/cc757XYJ.s 			page 4


 120              	.LVL12:
 121 0030 A061     		str	r0, [r4, #24]
 122              	.LVL13:
 123              	.L4:
  56:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
  57:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     return handle;
  58:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** }
 124              		.loc 1 58 0
 125 0032 2046     		mov	r0, r4
 126 0034 07B0     		add	sp, sp, #28
 127              	.LCFI2:
 128              		.cfi_remember_state
 129              		.cfi_def_cfa_offset 12
 130              		@ sp needed
 131 0036 30BD     		pop	{r4, r5, pc}
 132              	.LVL14:
 133              	.L9:
 134              	.LCFI3:
 135              		.cfi_restore_state
  42:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 136              		.loc 1 42 0 discriminator 4
 137 0038 FFF7FEFF 		bl	stm_log_timestamp
 138              	.LVL15:
 139 003c 1149     		ldr	r1, .L11
 140 003e 124B     		ldr	r3, .L11+4
 141 0040 0493     		str	r3, [sp, #16]
 142 0042 124B     		ldr	r3, .L11+8
 143 0044 0393     		str	r3, [sp, #12]
 144 0046 2A23     		movs	r3, #42
 145 0048 0293     		str	r3, [sp, #8]
 146 004a 114B     		ldr	r3, .L11+12
 147 004c 0193     		str	r3, [sp, #4]
 148 004e 0091     		str	r1, [sp]
 149 0050 0346     		mov	r3, r0
 150 0052 104A     		ldr	r2, .L11+16
 151 0054 0120     		movs	r0, #1
 152 0056 FFF7FEFF 		bl	stm_log_write
 153              	.LVL16:
 154 005a 0024     		movs	r4, #0
 155 005c E9E7     		b	.L4
 156              	.LVL17:
 157              	.L10:
  46:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 158              		.loc 1 46 0 discriminator 4
 159 005e FFF7FEFF 		bl	stm_log_timestamp
 160              	.LVL18:
 161 0062 0849     		ldr	r1, .L11
 162 0064 084B     		ldr	r3, .L11+4
 163 0066 0493     		str	r3, [sp, #16]
 164 0068 084B     		ldr	r3, .L11+8
 165 006a 0393     		str	r3, [sp, #12]
 166 006c 2E23     		movs	r3, #46
 167 006e 0293     		str	r3, [sp, #8]
 168 0070 074B     		ldr	r3, .L11+12
 169 0072 0193     		str	r3, [sp, #4]
 170 0074 0091     		str	r1, [sp]
 171 0076 0346     		mov	r3, r0
ARM GAS  /tmp/cc757XYJ.s 			page 5


 172 0078 064A     		ldr	r2, .L11+16
 173 007a 0120     		movs	r0, #1
 174 007c FFF7FEFF 		bl	stm_log_write
 175              	.LVL19:
 176 0080 D7E7     		b	.L4
 177              	.L12:
 178 0082 00BF     		.align	2
 179              	.L11:
 180 0084 28000000 		.word	.LC1
 181 0088 38000000 		.word	.LC2
 182 008c 00000000 		.word	.LANCHOR0
 183 0090 54000000 		.word	.LC3
 184 0094 00000000 		.word	.LC0
 185              		.cfi_endproc
 186              	.LFE6:
 188              		.section	.text.madgwick_set_beta,"ax",%progbits
 189              		.align	1
 190              		.global	madgwick_set_beta
 191              		.syntax unified
 192              		.thumb
 193              		.thumb_func
 194              		.fpu fpv4-sp-d16
 196              	madgwick_set_beta:
 197              	.LFB7:
  59:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
  60:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** void madgwick_set_beta(madgwick_handle_t handle, float beta)
  61:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** {
 198              		.loc 1 61 0
 199              		.cfi_startproc
 200              		@ args = 0, pretend = 0, frame = 0
 201              		@ frame_needed = 0, uses_anonymous_args = 0
 202              	.LVL20:
 203 0000 10B5     		push	{r4, lr}
 204              	.LCFI4:
 205              		.cfi_def_cfa_offset 8
 206              		.cfi_offset 4, -8
 207              		.cfi_offset 14, -4
 208 0002 2DED028B 		vpush.64	{d8}
 209              	.LCFI5:
 210              		.cfi_def_cfa_offset 16
 211              		.cfi_offset 80, -16
 212              		.cfi_offset 81, -12
 213 0006 0446     		mov	r4, r0
 214 0008 B0EE408A 		vmov.f32	s16, s0
 215              	.LVL21:
 216              	.L14:
  62:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     mutex_lock(handle->lock);
 217              		.loc 1 62 0 discriminator 1
 218 000c 4FF0FF31 		mov	r1, #-1
 219 0010 A069     		ldr	r0, [r4, #24]
 220 0012 FFF7FEFF 		bl	xQueueSemaphoreTake
 221              	.LVL22:
 222 0016 0128     		cmp	r0, #1
 223 0018 F8D1     		bne	.L14
  63:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->beta = beta;
 224              		.loc 1 63 0
 225 001a 84ED008A 		vstr.32	s16, [r4]
ARM GAS  /tmp/cc757XYJ.s 			page 6


  64:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     mutex_unlock(handle->lock);
 226              		.loc 1 64 0
 227 001e 0023     		movs	r3, #0
 228 0020 1A46     		mov	r2, r3
 229 0022 1946     		mov	r1, r3
 230 0024 A069     		ldr	r0, [r4, #24]
 231 0026 FFF7FEFF 		bl	xQueueGenericSend
 232              	.LVL23:
  65:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** }
 233              		.loc 1 65 0
 234 002a BDEC028B 		vldm	sp!, {d8}
 235              	.LCFI6:
 236              		.cfi_restore 80
 237              		.cfi_restore 81
 238              		.cfi_def_cfa_offset 8
 239              	.LVL24:
 240 002e 10BD     		pop	{r4, pc}
 241              		.cfi_endproc
 242              	.LFE7:
 244              		.section	.text.madgwick_set_sample_frequency,"ax",%progbits
 245              		.align	1
 246              		.global	madgwick_set_sample_frequency
 247              		.syntax unified
 248              		.thumb
 249              		.thumb_func
 250              		.fpu fpv4-sp-d16
 252              	madgwick_set_sample_frequency:
 253              	.LFB8:
  66:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
  67:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** void madgwick_set_sample_frequency(madgwick_handle_t handle, float sample_freq)
  68:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** {
 254              		.loc 1 68 0
 255              		.cfi_startproc
 256              		@ args = 0, pretend = 0, frame = 0
 257              		@ frame_needed = 0, uses_anonymous_args = 0
 258              	.LVL25:
 259 0000 10B5     		push	{r4, lr}
 260              	.LCFI7:
 261              		.cfi_def_cfa_offset 8
 262              		.cfi_offset 4, -8
 263              		.cfi_offset 14, -4
 264 0002 2DED028B 		vpush.64	{d8}
 265              	.LCFI8:
 266              		.cfi_def_cfa_offset 16
 267              		.cfi_offset 80, -16
 268              		.cfi_offset 81, -12
 269 0006 0446     		mov	r4, r0
 270 0008 B0EE408A 		vmov.f32	s16, s0
 271              	.LVL26:
 272              	.L17:
  69:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     mutex_lock(handle->lock);
 273              		.loc 1 69 0 discriminator 1
 274 000c 4FF0FF31 		mov	r1, #-1
 275 0010 A069     		ldr	r0, [r4, #24]
 276 0012 FFF7FEFF 		bl	xQueueSemaphoreTake
 277              	.LVL27:
 278 0016 0128     		cmp	r0, #1
ARM GAS  /tmp/cc757XYJ.s 			page 7


 279 0018 F8D1     		bne	.L17
  70:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->sample_freq = sample_freq;
 280              		.loc 1 70 0
 281 001a 84ED018A 		vstr.32	s16, [r4, #4]
  71:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     mutex_unlock(handle->lock);
 282              		.loc 1 71 0
 283 001e 0023     		movs	r3, #0
 284 0020 1A46     		mov	r2, r3
 285 0022 1946     		mov	r1, r3
 286 0024 A069     		ldr	r0, [r4, #24]
 287 0026 FFF7FEFF 		bl	xQueueGenericSend
 288              	.LVL28:
  72:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** }
 289              		.loc 1 72 0
 290 002a BDEC028B 		vldm	sp!, {d8}
 291              	.LCFI9:
 292              		.cfi_restore 80
 293              		.cfi_restore 81
 294              		.cfi_def_cfa_offset 8
 295              	.LVL29:
 296 002e 10BD     		pop	{r4, pc}
 297              		.cfi_endproc
 298              	.LFE8:
 300              		.section	.text.madgwick_get_quaternion,"ax",%progbits
 301              		.align	1
 302              		.global	madgwick_get_quaternion
 303              		.syntax unified
 304              		.thumb
 305              		.thumb_func
 306              		.fpu fpv4-sp-d16
 308              	madgwick_get_quaternion:
 309              	.LFB9:
  73:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
  74:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** void madgwick_get_quaternion(madgwick_handle_t handle, imu_quat_data_t *quat_data)
  75:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** {
 310              		.loc 1 75 0
 311              		.cfi_startproc
 312              		@ args = 0, pretend = 0, frame = 0
 313              		@ frame_needed = 0, uses_anonymous_args = 0
 314              	.LVL30:
 315 0000 38B5     		push	{r3, r4, r5, lr}
 316              	.LCFI10:
 317              		.cfi_def_cfa_offset 16
 318              		.cfi_offset 3, -16
 319              		.cfi_offset 4, -12
 320              		.cfi_offset 5, -8
 321              		.cfi_offset 14, -4
 322 0002 0446     		mov	r4, r0
 323 0004 0D46     		mov	r5, r1
 324              	.LVL31:
 325              	.L20:
  76:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     mutex_lock(handle->lock);
 326              		.loc 1 76 0 discriminator 1
 327 0006 4FF0FF31 		mov	r1, #-1
 328 000a A069     		ldr	r0, [r4, #24]
 329 000c FFF7FEFF 		bl	xQueueSemaphoreTake
 330              	.LVL32:
ARM GAS  /tmp/cc757XYJ.s 			page 8


 331 0010 0128     		cmp	r0, #1
 332 0012 F8D1     		bne	.L20
  77:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     quat_data->q0 = handle->q0;
 333              		.loc 1 77 0
 334 0014 A368     		ldr	r3, [r4, #8]	@ float
 335 0016 2B60     		str	r3, [r5]	@ float
  78:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     quat_data->q1 = handle->q1;
 336              		.loc 1 78 0
 337 0018 E368     		ldr	r3, [r4, #12]	@ float
 338 001a 6B60     		str	r3, [r5, #4]	@ float
  79:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     quat_data->q2 = handle->q2;
 339              		.loc 1 79 0
 340 001c 2369     		ldr	r3, [r4, #16]	@ float
 341 001e AB60     		str	r3, [r5, #8]	@ float
  80:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     quat_data->q3 = handle->q3;
 342              		.loc 1 80 0
 343 0020 6369     		ldr	r3, [r4, #20]	@ float
 344 0022 EB60     		str	r3, [r5, #12]	@ float
  81:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     mutex_unlock(handle->lock);
 345              		.loc 1 81 0
 346 0024 0023     		movs	r3, #0
 347 0026 1A46     		mov	r2, r3
 348 0028 1946     		mov	r1, r3
 349 002a A069     		ldr	r0, [r4, #24]
 350 002c FFF7FEFF 		bl	xQueueGenericSend
 351              	.LVL33:
 352 0030 38BD     		pop	{r3, r4, r5, pc}
 353              		.cfi_endproc
 354              	.LFE9:
 356              		.section	.text.madgwick_update_6dof,"ax",%progbits
 357              		.align	1
 358              		.global	madgwick_update_6dof
 359              		.syntax unified
 360              		.thumb
 361              		.thumb_func
 362              		.fpu fpv4-sp-d16
 364              	madgwick_update_6dof:
 365              	.LFB10:
  82:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** }
  83:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
  84:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** void madgwick_update_6dof(madgwick_handle_t handle, float gx, float gy, float gz, float ax, float a
  85:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** {
 366              		.loc 1 85 0
 367              		.cfi_startproc
 368              		@ args = 0, pretend = 0, frame = 0
 369              		@ frame_needed = 0, uses_anonymous_args = 0
 370              	.LVL34:
 371 0000 10B5     		push	{r4, lr}
 372              	.LCFI11:
 373              		.cfi_def_cfa_offset 8
 374              		.cfi_offset 4, -8
 375              		.cfi_offset 14, -4
 376 0002 2DED108B 		vpush.64	{d8, d9, d10, d11, d12, d13, d14, d15}
 377              	.LCFI12:
 378              		.cfi_def_cfa_offset 72
 379              		.cfi_offset 80, -72
 380              		.cfi_offset 81, -68
ARM GAS  /tmp/cc757XYJ.s 			page 9


 381              		.cfi_offset 82, -64
 382              		.cfi_offset 83, -60
 383              		.cfi_offset 84, -56
 384              		.cfi_offset 85, -52
 385              		.cfi_offset 86, -48
 386              		.cfi_offset 87, -44
 387              		.cfi_offset 88, -40
 388              		.cfi_offset 89, -36
 389              		.cfi_offset 90, -32
 390              		.cfi_offset 91, -28
 391              		.cfi_offset 92, -24
 392              		.cfi_offset 93, -20
 393              		.cfi_offset 94, -16
 394              		.cfi_offset 95, -12
 395 0006 0446     		mov	r4, r0
 396 0008 B0EE40CA 		vmov.f32	s24, s0
 397 000c B0EE60FA 		vmov.f32	s30, s1
 398 0010 B0EE41BA 		vmov.f32	s22, s2
 399 0014 B0EE619A 		vmov.f32	s18, s3
 400 0018 F0EE428A 		vmov.f32	s17, s4
 401 001c B0EE628A 		vmov.f32	s16, s5
 402              	.LVL35:
 403              	.L23:
  86:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     mutex_lock(handle->lock);
 404              		.loc 1 86 0 discriminator 1
 405 0020 4FF0FF31 		mov	r1, #-1
 406 0024 A069     		ldr	r0, [r4, #24]
 407 0026 FFF7FEFF 		bl	xQueueSemaphoreTake
 408              	.LVL36:
 409 002a 0128     		cmp	r0, #1
 410 002c F8D1     		bne	.L23
  87:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     
  88:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float q0 = handle->q0;
 411              		.loc 1 88 0
 412 002e D4ED02DA 		vldr.32	s27, [r4, #8]
 413              	.LVL37:
  89:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float q1 = handle->q1;
 414              		.loc 1 89 0
 415 0032 94ED03DA 		vldr.32	s26, [r4, #12]
 416              	.LVL38:
  90:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float q2 = handle->q2;
 417              		.loc 1 90 0
 418 0036 D4ED04CA 		vldr.32	s25, [r4, #16]
 419              	.LVL39:
  91:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float q3 = handle->q3;
 420              		.loc 1 91 0
 421 003a D4ED05BA 		vldr.32	s23, [r4, #20]
 422              	.LVL40:
  92:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float beta = handle->beta;
 423              		.loc 1 92 0
 424 003e 94ED00EA 		vldr.32	s28, [r4]
 425              	.LVL41:
  93:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float sampleFreq = handle->sample_freq;
 426              		.loc 1 93 0
 427 0042 D4ED01EA 		vldr.32	s29, [r4, #4]
 428              	.LVL42:
  94:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float recipNorm;
ARM GAS  /tmp/cc757XYJ.s 			page 10


  95:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float s0, s1, s2, s3;
  96:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float qDot1, qDot2, qDot3, qDot4;
  97:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float _2q0, _2q1, _2q2, _2q3, _4q0, _4q1, _4q2 , _8q1, _8q2, q0q0, q1q1, q2q2, q3q3;
  98:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
  99:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     // Rate of change of quaternion from gyroscope
 100:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     qDot1 = 0.5f * (-q1 * gx - q2 * gy - q3 * gz);
 429              		.loc 1 100 0
 430 0046 6DEE4CAA 		vnmul.f32	s21, s26, s24
 431 004a 6CEE8F7A 		vmul.f32	s15, s25, s30
 432 004e 7AEEE7AA 		vsub.f32	s21, s21, s15
 433 0052 6BEE8B7A 		vmul.f32	s15, s23, s22
 434 0056 7AEEE7AA 		vsub.f32	s21, s21, s15
 435 005a F6EE007A 		vmov.f32	s15, #5.0e-1
 436 005e 6AEEA7AA 		vmul.f32	s21, s21, s15
 437              	.LVL43:
 101:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     qDot2 = 0.5f * (q0 * gx + q2 * gz - q3 * gy);
 438              		.loc 1 101 0
 439 0062 2DEE8CAA 		vmul.f32	s20, s27, s24
 440 0066 2CEE8B7A 		vmul.f32	s14, s25, s22
 441 006a 3AEE07AA 		vadd.f32	s20, s20, s14
 442 006e 2BEE8F7A 		vmul.f32	s14, s23, s30
 443 0072 3AEE47AA 		vsub.f32	s20, s20, s14
 444 0076 2AEE27AA 		vmul.f32	s20, s20, s15
 445              	.LVL44:
 102:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     qDot3 = 0.5f * (q0 * gy - q1 * gz + q3 * gx);
 446              		.loc 1 102 0
 447 007a 6DEE8F9A 		vmul.f32	s19, s27, s30
 448 007e 2DEE0B7A 		vmul.f32	s14, s26, s22
 449 0082 79EEC79A 		vsub.f32	s19, s19, s14
 450 0086 2BEE8C7A 		vmul.f32	s14, s23, s24
 451 008a 79EE879A 		vadd.f32	s19, s19, s14
 452 008e 69EEA79A 		vmul.f32	s19, s19, s15
 453              	.LVL45:
 103:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     qDot4 = 0.5f * (q0 * gz + q1 * gy - q2 * gx);
 454              		.loc 1 103 0
 455 0092 2DEE8BBA 		vmul.f32	s22, s27, s22
 456              	.LVL46:
 457 0096 6DEE0F0A 		vmul.f32	s1, s26, s30
 458 009a 3BEE20BA 		vadd.f32	s22, s22, s1
 459 009e 2CEE8C0A 		vmul.f32	s0, s25, s24
 460 00a2 3BEE40BA 		vsub.f32	s22, s22, s0
 461 00a6 2BEE27BA 		vmul.f32	s22, s22, s15
 462              	.LVL47:
 104:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 105:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     // Compute feedback only if accelerometer measurement valid (avoids NaN in accelerometer normal
 106:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     if (!((ax == 0.0f) && (ay == 0.0f) && (az == 0.0f))) {
 463              		.loc 1 106 0
 464 00aa B5EE409A 		vcmp.f32	s18, #0
 465 00ae F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 466 00b2 0AD1     		bne	.L24
 467              		.loc 1 106 0 is_stmt 0 discriminator 1
 468 00b4 F5EE408A 		vcmp.f32	s17, #0
 469 00b8 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 470 00bc 05D1     		bne	.L24
 471              		.loc 1 106 0 discriminator 2
 472 00be B5EE408A 		vcmp.f32	s16, #0
 473 00c2 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
ARM GAS  /tmp/cc757XYJ.s 			page 11


 474 00c6 00F0B280 		beq	.L25
 475              	.L24:
 107:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 108:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         // Normalise accelerometer measurement
 109:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         recipNorm = invSqrt(ax * ax + ay * ay + az * az);
 476              		.loc 1 109 0 is_stmt 1
 477 00ca 69EE097A 		vmul.f32	s15, s18, s18
 478 00ce 28EEA80A 		vmul.f32	s0, s17, s17
 479 00d2 77EE807A 		vadd.f32	s15, s15, s0
 480 00d6 28EE080A 		vmul.f32	s0, s16, s16
 481 00da 37EE800A 		vadd.f32	s0, s15, s0
 482 00de FFF7FEFF 		bl	invSqrt
 483              	.LVL48:
 110:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         ax *= recipNorm;
 484              		.loc 1 110 0
 485 00e2 69EE001A 		vmul.f32	s3, s18, s0
 486              	.LVL49:
 111:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         ay *= recipNorm;
 487              		.loc 1 111 0
 488 00e6 28EE802A 		vmul.f32	s4, s17, s0
 489              	.LVL50:
 112:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         az *= recipNorm;
 490              		.loc 1 112 0
 491 00ea 28EE000A 		vmul.f32	s0, s16, s0
 492              	.LVL51:
 113:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 114:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         // Auxiliary variables to avoid repeated arithmetic
 115:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q0 = 2.0f * q0;
 493              		.loc 1 115 0
 494 00ee 3DEEAD8A 		vadd.f32	s16, s27, s27
 116:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q1 = 2.0f * q1;
 495              		.loc 1 116 0
 496 00f2 3DEE0D5A 		vadd.f32	s10, s26, s26
 117:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q2 = 2.0f * q2;
 497              		.loc 1 117 0
 498 00f6 7CEEAC5A 		vadd.f32	s11, s25, s25
 118:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q3 = 2.0f * q3;
 499              		.loc 1 118 0
 500 00fa 7BEEAB3A 		vadd.f32	s7, s23, s23
 119:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _4q0 = 4.0f * q0;
 501              		.loc 1 119 0
 502 00fe B1EE006A 		vmov.f32	s12, #4.0e+0
 503 0102 6DEE860A 		vmul.f32	s1, s27, s12
 504              	.LVL52:
 120:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _4q1 = 4.0f * q1;
 505              		.loc 1 120 0
 506 0106 6DEE062A 		vmul.f32	s5, s26, s12
 507              	.LVL53:
 121:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _4q2 = 4.0f * q2;
 508              		.loc 1 121 0
 509 010a 6CEE864A 		vmul.f32	s9, s25, s12
 510              	.LVL54:
 122:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _8q1 = 8.0f * q1;
 511              		.loc 1 122 0
 512 010e B2EE004A 		vmov.f32	s8, #8.0e+0
 513 0112 2DEE041A 		vmul.f32	s2, s26, s8
 514              	.LVL55:
ARM GAS  /tmp/cc757XYJ.s 			page 12


 123:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _8q2 = 8.0f * q2;
 515              		.loc 1 123 0
 516 0116 2CEE844A 		vmul.f32	s8, s25, s8
 517              	.LVL56:
 124:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q0q0 = q0 * q0;
 518              		.loc 1 124 0
 519 011a 2DEEAD7A 		vmul.f32	s14, s27, s27
 520              	.LVL57:
 125:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q1q1 = q1 * q1;
 521              		.loc 1 125 0
 522 011e 6DEE0D7A 		vmul.f32	s15, s26, s26
 523              	.LVL58:
 126:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q2q2 = q2 * q2;
 524              		.loc 1 126 0
 525 0122 6CEEAC6A 		vmul.f32	s13, s25, s25
 526              	.LVL59:
 127:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q3q3 = q3 * q3;
 527              		.loc 1 127 0
 528 0126 2BEEAB3A 		vmul.f32	s6, s23, s23
 128:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 129:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         // Gradient decent algorithm corrective step
 130:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s0 = _4q0 * q2q2 + _2q2 * ax + _4q0 * q1q1 - _2q1 * ay;
 529              		.loc 1 130 0
 530 012a 20EEA6CA 		vmul.f32	s24, s1, s13
 531              	.LVL60:
 532 012e 61EEA58A 		vmul.f32	s17, s3, s11
 533 0132 3CEE28CA 		vadd.f32	s24, s24, s17
 534 0136 60EEA70A 		vmul.f32	s1, s1, s15
 535              	.LVL61:
 536 013a 3CEE20CA 		vadd.f32	s24, s24, s1
 537 013e 62EE050A 		vmul.f32	s1, s4, s10
 538 0142 3CEE60CA 		vsub.f32	s24, s24, s1
 539              	.LVL62:
 131:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s1 = _4q1 * q3q3 - _2q3 * ax + 4.0f * q0q0 * q1 - _2q0 * ay - _4q1 + _8q1 * q1q1 + _8q1 * q
 540              		.loc 1 131 0
 541 0146 22EE839A 		vmul.f32	s18, s5, s6
 542 014a 61EEA30A 		vmul.f32	s1, s3, s7
 543 014e 39EE609A 		vsub.f32	s18, s18, s1
 544 0152 27EE067A 		vmul.f32	s14, s14, s12
 545              	.LVL63:
 546 0156 6DEE070A 		vmul.f32	s1, s26, s14
 547 015a 39EE209A 		vadd.f32	s18, s18, s1
 548 015e 62EE080A 		vmul.f32	s1, s4, s16
 549 0162 39EE609A 		vsub.f32	s18, s18, s1
 550 0166 39EE629A 		vsub.f32	s18, s18, s5
 551 016a 61EE270A 		vmul.f32	s1, s2, s15
 552 016e 39EE209A 		vadd.f32	s18, s18, s1
 553 0172 21EE261A 		vmul.f32	s2, s2, s13
 554              	.LVL64:
 555 0176 39EE019A 		vadd.f32	s18, s18, s2
 556 017a 60EE222A 		vmul.f32	s5, s0, s5
 557              	.LVL65:
 558 017e 39EE229A 		vadd.f32	s18, s18, s5
 559              	.LVL66:
 132:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s2 = 4.0f * q0q0 * q2 + _2q0 * ax + _4q2 * q3q3 - _2q3 * ay - _4q2 + _8q2 * q1q1 + _8q2 * q
 560              		.loc 1 132 0
 561 0182 2CEE877A 		vmul.f32	s14, s25, s14
ARM GAS  /tmp/cc757XYJ.s 			page 13


 562 0186 21EE888A 		vmul.f32	s16, s3, s16
 563 018a 37EE087A 		vadd.f32	s14, s14, s16
 564 018e 24EE838A 		vmul.f32	s16, s9, s6
 565 0192 37EE088A 		vadd.f32	s16, s14, s16
 566 0196 62EE233A 		vmul.f32	s7, s4, s7
 567 019a 38EE638A 		vsub.f32	s16, s16, s7
 568 019e 38EE648A 		vsub.f32	s16, s16, s9
 569 01a2 24EE277A 		vmul.f32	s14, s8, s15
 570 01a6 38EE078A 		vadd.f32	s16, s16, s14
 571 01aa 24EE264A 		vmul.f32	s8, s8, s13
 572              	.LVL67:
 573 01ae 38EE048A 		vadd.f32	s16, s16, s8
 574 01b2 20EE240A 		vmul.f32	s0, s0, s9
 575              	.LVL68:
 576 01b6 38EE008A 		vadd.f32	s16, s16, s0
 577              	.LVL69:
 133:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s3 = 4.0f * q1q1 * q3 - _2q1 * ax + 4.0f * q2q2 * q3 - _2q2 * ay;
 578              		.loc 1 133 0
 579 01ba 67EE868A 		vmul.f32	s17, s15, s12
 580 01be 6BEEA88A 		vmul.f32	s17, s23, s17
 581 01c2 61EE851A 		vmul.f32	s3, s3, s10
 582              	.LVL70:
 583 01c6 78EEE18A 		vsub.f32	s17, s17, s3
 584 01ca 66EE866A 		vmul.f32	s13, s13, s12
 585              	.LVL71:
 586 01ce 6BEEA66A 		vmul.f32	s13, s23, s13
 587 01d2 78EEA68A 		vadd.f32	s17, s17, s13
 588 01d6 22EE252A 		vmul.f32	s4, s4, s11
 589              	.LVL72:
 590 01da 78EEC28A 		vsub.f32	s17, s17, s4
 591              	.LVL73:
 134:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         recipNorm = invSqrt(s0 * s0 + s1 * s1 + s2 * s2 + s3 * s3); // normalise step magnitude
 592              		.loc 1 134 0
 593 01de 6CEE0C7A 		vmul.f32	s15, s24, s24
 594              	.LVL74:
 595 01e2 29EE090A 		vmul.f32	s0, s18, s18
 596 01e6 77EE807A 		vadd.f32	s15, s15, s0
 597 01ea 28EE080A 		vmul.f32	s0, s16, s16
 598 01ee 77EE807A 		vadd.f32	s15, s15, s0
 599 01f2 28EEA80A 		vmul.f32	s0, s17, s17
 600 01f6 37EE800A 		vadd.f32	s0, s15, s0
 601 01fa FFF7FEFF 		bl	invSqrt
 602              	.LVL75:
 135:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s0 *= recipNorm;
 603              		.loc 1 135 0
 604 01fe 2CEE00CA 		vmul.f32	s24, s24, s0
 605              	.LVL76:
 136:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s1 *= recipNorm;
 606              		.loc 1 136 0
 607 0202 29EE009A 		vmul.f32	s18, s18, s0
 608              	.LVL77:
 137:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s2 *= recipNorm;
 609              		.loc 1 137 0
 610 0206 28EE008A 		vmul.f32	s16, s16, s0
 611              	.LVL78:
 138:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s3 *= recipNorm;
 612              		.loc 1 138 0
ARM GAS  /tmp/cc757XYJ.s 			page 14


 613 020a 68EE808A 		vmul.f32	s17, s17, s0
 614              	.LVL79:
 139:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 140:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         // Apply feedback step
 141:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         qDot1 -= beta * s0;
 615              		.loc 1 141 0
 616 020e 2EEE0CCA 		vmul.f32	s24, s28, s24
 617              	.LVL80:
 618 0212 7AEECCAA 		vsub.f32	s21, s21, s24
 619              	.LVL81:
 142:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         qDot2 -= beta * s1;
 620              		.loc 1 142 0
 621 0216 2EEE099A 		vmul.f32	s18, s28, s18
 622              	.LVL82:
 623 021a 3AEE49AA 		vsub.f32	s20, s20, s18
 624              	.LVL83:
 143:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         qDot3 -= beta * s2;
 625              		.loc 1 143 0
 626 021e 2EEE088A 		vmul.f32	s16, s28, s16
 627              	.LVL84:
 628 0222 79EEC89A 		vsub.f32	s19, s19, s16
 629              	.LVL85:
 144:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         qDot4 -= beta * s3;
 630              		.loc 1 144 0
 631 0226 2EEE28EA 		vmul.f32	s28, s28, s17
 632              	.LVL86:
 633 022a 3BEE4EBA 		vsub.f32	s22, s22, s28
 634              	.LVL87:
 635              	.L25:
 145:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     }
 146:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 147:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     // Integrate rate of change of quaternion to yield quaternion
 148:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q0 += qDot1 * (1.0f / sampleFreq);
 636              		.loc 1 148 0
 637 022e B7EE007A 		vmov.f32	s14, #1.0e+0
 638 0232 C7EE2E7A 		vdiv.f32	s15, s14, s29
 639 0236 6AEEA7AA 		vmul.f32	s21, s21, s15
 640              	.LVL88:
 641 023a 7DEEAADA 		vadd.f32	s27, s27, s21
 642              	.LVL89:
 149:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q1 += qDot2 * (1.0f / sampleFreq);
 643              		.loc 1 149 0
 644 023e 2AEE27AA 		vmul.f32	s20, s20, s15
 645              	.LVL90:
 646 0242 3DEE0ADA 		vadd.f32	s26, s26, s20
 647              	.LVL91:
 150:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q2 += qDot3 * (1.0f / sampleFreq);
 648              		.loc 1 150 0
 649 0246 69EEA79A 		vmul.f32	s19, s19, s15
 650              	.LVL92:
 651 024a 7CEEA9CA 		vadd.f32	s25, s25, s19
 652              	.LVL93:
 151:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q3 += qDot4 * (1.0f / sampleFreq);
 653              		.loc 1 151 0
 654 024e 2BEE27BA 		vmul.f32	s22, s22, s15
 655              	.LVL94:
 656 0252 7BEE8BBA 		vadd.f32	s23, s23, s22
ARM GAS  /tmp/cc757XYJ.s 			page 15


 657              	.LVL95:
 152:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 153:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     // Normalise quaternion
 154:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     recipNorm = invSqrt(q0 * q0 + q1 * q1 + q2 * q2 + q3 * q3);
 658              		.loc 1 154 0
 659 0256 6DEEAD7A 		vmul.f32	s15, s27, s27
 660 025a 2DEE0D0A 		vmul.f32	s0, s26, s26
 661 025e 77EE807A 		vadd.f32	s15, s15, s0
 662 0262 2CEEAC0A 		vmul.f32	s0, s25, s25
 663 0266 77EE807A 		vadd.f32	s15, s15, s0
 664 026a 2BEEAB0A 		vmul.f32	s0, s23, s23
 665 026e 37EE800A 		vadd.f32	s0, s15, s0
 666 0272 FFF7FEFF 		bl	invSqrt
 667              	.LVL96:
 155:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q0 *= recipNorm;
 668              		.loc 1 155 0
 669 0276 6DEE80DA 		vmul.f32	s27, s27, s0
 670              	.LVL97:
 156:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q1 *= recipNorm;
 671              		.loc 1 156 0
 672 027a 2DEE00DA 		vmul.f32	s26, s26, s0
 673              	.LVL98:
 157:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q2 *= recipNorm;
 674              		.loc 1 157 0
 675 027e 6CEE80CA 		vmul.f32	s25, s25, s0
 676              	.LVL99:
 158:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q3 *= recipNorm;
 677              		.loc 1 158 0
 678 0282 6BEE80BA 		vmul.f32	s23, s23, s0
 679              	.LVL100:
 159:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 160:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->q0 = q0;
 680              		.loc 1 160 0
 681 0286 C4ED02DA 		vstr.32	s27, [r4, #8]
 161:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->q1 = q1;
 682              		.loc 1 161 0
 683 028a 84ED03DA 		vstr.32	s26, [r4, #12]
 162:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->q2 = q2;
 684              		.loc 1 162 0
 685 028e C4ED04CA 		vstr.32	s25, [r4, #16]
 163:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->q3 = q3;
 686              		.loc 1 163 0
 687 0292 C4ED05BA 		vstr.32	s23, [r4, #20]
 164:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 165:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     mutex_unlock(handle->lock);
 688              		.loc 1 165 0
 689 0296 0023     		movs	r3, #0
 690 0298 1A46     		mov	r2, r3
 691 029a 1946     		mov	r1, r3
 692 029c A069     		ldr	r0, [r4, #24]
 693 029e FFF7FEFF 		bl	xQueueGenericSend
 694              	.LVL101:
 166:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** }
 695              		.loc 1 166 0
 696 02a2 BDEC108B 		vldm	sp!, {d8-d15}
 697              	.LCFI13:
 698              		.cfi_restore 94
ARM GAS  /tmp/cc757XYJ.s 			page 16


 699              		.cfi_restore 95
 700              		.cfi_restore 92
 701              		.cfi_restore 93
 702              		.cfi_restore 90
 703              		.cfi_restore 91
 704              		.cfi_restore 88
 705              		.cfi_restore 89
 706              		.cfi_restore 86
 707              		.cfi_restore 87
 708              		.cfi_restore 84
 709              		.cfi_restore 85
 710              		.cfi_restore 82
 711              		.cfi_restore 83
 712              		.cfi_restore 80
 713              		.cfi_restore 81
 714              		.cfi_def_cfa_offset 8
 715              	.LVL102:
 716 02a6 10BD     		pop	{r4, pc}
 717              		.cfi_endproc
 718              	.LFE10:
 720              		.global	__aeabi_f2d
 721              		.global	__aeabi_d2f
 722              		.section	.text.madgwick_update_9dof,"ax",%progbits
 723              		.align	1
 724              		.global	madgwick_update_9dof
 725              		.syntax unified
 726              		.thumb
 727              		.thumb_func
 728              		.fpu fpv4-sp-d16
 730              	madgwick_update_9dof:
 731              	.LFB11:
 167:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 168:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** void madgwick_update_9dof(madgwick_handle_t handle, float gx, float gy, float gz, float ax, float a
 169:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** {
 732              		.loc 1 169 0
 733              		.cfi_startproc
 734              		@ args = 0, pretend = 0, frame = 48
 735              		@ frame_needed = 0, uses_anonymous_args = 0
 736              	.LVL103:
 737 0000 10B5     		push	{r4, lr}
 738              	.LCFI14:
 739              		.cfi_def_cfa_offset 8
 740              		.cfi_offset 4, -8
 741              		.cfi_offset 14, -4
 742 0002 2DED108B 		vpush.64	{d8, d9, d10, d11, d12, d13, d14, d15}
 743              	.LCFI15:
 744              		.cfi_def_cfa_offset 72
 745              		.cfi_offset 80, -72
 746              		.cfi_offset 81, -68
 747              		.cfi_offset 82, -64
 748              		.cfi_offset 83, -60
 749              		.cfi_offset 84, -56
 750              		.cfi_offset 85, -52
 751              		.cfi_offset 86, -48
 752              		.cfi_offset 87, -44
 753              		.cfi_offset 88, -40
 754              		.cfi_offset 89, -36
ARM GAS  /tmp/cc757XYJ.s 			page 17


 755              		.cfi_offset 90, -32
 756              		.cfi_offset 91, -28
 757              		.cfi_offset 92, -24
 758              		.cfi_offset 93, -20
 759              		.cfi_offset 94, -16
 760              		.cfi_offset 95, -12
 761 0006 8CB0     		sub	sp, sp, #48
 762              	.LCFI16:
 763              		.cfi_def_cfa_offset 120
 764 0008 0446     		mov	r4, r0
 765 000a B0EE409A 		vmov.f32	s18, s0
 766 000e B0EE60AA 		vmov.f32	s20, s1
 767 0012 F0EE418A 		vmov.f32	s17, s2
 768 0016 B0EE61BA 		vmov.f32	s22, s3
 769 001a F0EE42DA 		vmov.f32	s27, s4
 770 001e B0EE62EA 		vmov.f32	s28, s5
 771 0022 B0EE43DA 		vmov.f32	s26, s6
 772 0026 B0EE63CA 		vmov.f32	s24, s7
 773 002a F0EE44CA 		vmov.f32	s25, s8
 774              	.LVL104:
 775              	.L28:
 170:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     mutex_lock(handle->lock);
 776              		.loc 1 170 0 discriminator 1
 777 002e 4FF0FF31 		mov	r1, #-1
 778 0032 A069     		ldr	r0, [r4, #24]
 779 0034 FFF7FEFF 		bl	xQueueSemaphoreTake
 780              	.LVL105:
 781 0038 0128     		cmp	r0, #1
 782 003a F8D1     		bne	.L28
 171:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 172:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float q0 = handle->q0;
 783              		.loc 1 172 0
 784 003c D4ED02BA 		vldr.32	s23, [r4, #8]
 785              	.LVL106:
 173:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float q1 = handle->q1;
 786              		.loc 1 173 0
 787 0040 D4ED03AA 		vldr.32	s21, [r4, #12]
 788              	.LVL107:
 174:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float q2 = handle->q2;
 789              		.loc 1 174 0
 790 0044 D4ED049A 		vldr.32	s19, [r4, #16]
 791              	.LVL108:
 175:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float q3 = handle->q3;
 792              		.loc 1 175 0
 793 0048 94ED058A 		vldr.32	s16, [r4, #20]
 794              	.LVL109:
 176:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float beta = handle->beta;
 795              		.loc 1 176 0
 796 004c D4ED007A 		vldr.32	s15, [r4]
 797 0050 CDED057A 		vstr.32	s15, [sp, #20]
 798              	.LVL110:
 177:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float sampleFreq = handle->sample_freq;
 799              		.loc 1 177 0
 800 0054 D4ED017A 		vldr.32	s15, [r4, #4]
 801              	.LVL111:
 802 0058 CDED047A 		vstr.32	s15, [sp, #16]
 803              	.LVL112:
ARM GAS  /tmp/cc757XYJ.s 			page 18


 178:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float recipNorm;
 179:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float s0, s1, s2, s3;
 180:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float qDot1, qDot2, qDot3, qDot4;
 181:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float hx, hy;
 182:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     float _2q0mx, _2q0my, _2q0mz, _2q1mx, _2bx, _2bz, _4bx, _4bz, _2q0, _2q1, _2q2, _2q3, _2q0q2, _
 183:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 184:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     // Use IMU algorithm if magnetometer measurement invalid (avoids NaN in magnetometer normalisat
 185:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     if ((mx == 0.0f) && (my == 0.0f) && (mz == 0.0f)) {
 804              		.loc 1 185 0
 805 005c B5EE40DA 		vcmp.f32	s26, #0
 806 0060 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 807 0064 0AD1     		bne	.L29
 808              		.loc 1 185 0 is_stmt 0 discriminator 1
 809 0066 B5EE40CA 		vcmp.f32	s24, #0
 810 006a F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 811 006e 05D1     		bne	.L29
 812              		.loc 1 185 0 discriminator 2
 813 0070 F5EE40CA 		vcmp.f32	s25, #0
 814 0074 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 815 0078 00F07482 		beq	.L34
 816              	.L29:
 186:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         madgwick_update_6dof(handle, gx, gy, gz, ax, ay, az);
 187:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         return;
 188:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     }
 189:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 190:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     // Rate of change of quaternion from gyroscope
 191:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     qDot1 = 0.5f * (-q1 * gx - q2 * gy - q3 * gz);
 817              		.loc 1 191 0 is_stmt 1
 818 007c 6AEEC97A 		vnmul.f32	s15, s21, s18
 819              	.LVL113:
 820 0080 29EE8A7A 		vmul.f32	s14, s19, s20
 821 0084 77EEC77A 		vsub.f32	s15, s15, s14
 822 0088 28EE287A 		vmul.f32	s14, s16, s17
 823 008c 77EEC77A 		vsub.f32	s15, s15, s14
 824 0090 B6EE007A 		vmov.f32	s14, #5.0e-1
 825 0094 67EE877A 		vmul.f32	s15, s15, s14
 826 0098 CDED007A 		vstr.32	s15, [sp]
 827              	.LVL114:
 192:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     qDot2 = 0.5f * (q0 * gx + q2 * gz - q3 * gy);
 828              		.loc 1 192 0
 829 009c 6BEE897A 		vmul.f32	s15, s23, s18
 830              	.LVL115:
 831 00a0 69EEA86A 		vmul.f32	s13, s19, s17
 832 00a4 77EEA67A 		vadd.f32	s15, s15, s13
 833 00a8 68EE0A6A 		vmul.f32	s13, s16, s20
 834 00ac 77EEE67A 		vsub.f32	s15, s15, s13
 835 00b0 67EE877A 		vmul.f32	s15, s15, s14
 836 00b4 CDED017A 		vstr.32	s15, [sp, #4]
 837              	.LVL116:
 193:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     qDot3 = 0.5f * (q0 * gy - q1 * gz + q3 * gx);
 838              		.loc 1 193 0
 839 00b8 6BEE8A7A 		vmul.f32	s15, s23, s20
 840              	.LVL117:
 841 00bc 6AEEA86A 		vmul.f32	s13, s21, s17
 842 00c0 77EEE67A 		vsub.f32	s15, s15, s13
 843 00c4 68EE096A 		vmul.f32	s13, s16, s18
 844 00c8 77EEA67A 		vadd.f32	s15, s15, s13
ARM GAS  /tmp/cc757XYJ.s 			page 19


 845 00cc 67EE877A 		vmul.f32	s15, s15, s14
 846 00d0 CDED027A 		vstr.32	s15, [sp, #8]
 847              	.LVL118:
 194:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     qDot4 = 0.5f * (q0 * gz + q1 * gy - q2 * gx);
 848              		.loc 1 194 0
 849 00d4 6BEEA88A 		vmul.f32	s17, s23, s17
 850              	.LVL119:
 851 00d8 2AEE8AAA 		vmul.f32	s20, s21, s20
 852              	.LVL120:
 853 00dc 78EE8A8A 		vadd.f32	s17, s17, s20
 854 00e0 29EE899A 		vmul.f32	s18, s19, s18
 855              	.LVL121:
 856 00e4 38EEC99A 		vsub.f32	s18, s17, s18
 857 00e8 69EE077A 		vmul.f32	s15, s18, s14
 858              	.LVL122:
 859 00ec CDED037A 		vstr.32	s15, [sp, #12]
 860              	.LVL123:
 195:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 196:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     // Compute feedback only if accelerometer measurement valid (avoids NaN in accelerometer normal
 197:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     if (!((ax == 0.0f) && (ay == 0.0f) && (az == 0.0f))) {
 861              		.loc 1 197 0
 862 00f0 B5EE40BA 		vcmp.f32	s22, #0
 863 00f4 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 864 00f8 0AD1     		bne	.L31
 865              		.loc 1 197 0 is_stmt 0 discriminator 1
 866 00fa F5EE40DA 		vcmp.f32	s27, #0
 867 00fe F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 868 0102 05D1     		bne	.L31
 869              		.loc 1 197 0 discriminator 2
 870 0104 B5EE40EA 		vcmp.f32	s28, #0
 871 0108 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 872 010c 00F0E281 		beq	.L32
 873              	.L31:
 198:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 199:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         // Normalise accelerometer measurement
 200:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         recipNorm = invSqrt(ax * ax + ay * ay + az * az);
 874              		.loc 1 200 0 is_stmt 1
 875 0110 6BEE0B7A 		vmul.f32	s15, s22, s22
 876              	.LVL124:
 877 0114 2DEEAD0A 		vmul.f32	s0, s27, s27
 878 0118 77EE807A 		vadd.f32	s15, s15, s0
 879 011c 2EEE0E0A 		vmul.f32	s0, s28, s28
 880 0120 37EE800A 		vadd.f32	s0, s15, s0
 881 0124 FFF7FEFF 		bl	invSqrt
 882              	.LVL125:
 201:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         ax *= recipNorm;
 883              		.loc 1 201 0
 884 0128 6BEE007A 		vmul.f32	s15, s22, s0
 885 012c CDED067A 		vstr.32	s15, [sp, #24]
 886              	.LVL126:
 202:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         ay *= recipNorm;
 887              		.loc 1 202 0
 888 0130 6DEE806A 		vmul.f32	s13, s27, s0
 889 0134 CDED076A 		vstr.32	s13, [sp, #28]
 890              	.LVL127:
 203:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         az *= recipNorm;
 891              		.loc 1 203 0
ARM GAS  /tmp/cc757XYJ.s 			page 20


 892 0138 2EEE006A 		vmul.f32	s12, s28, s0
 893 013c 8DED086A 		vstr.32	s12, [sp, #32]
 894              	.LVL128:
 204:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 205:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         // Normalise magnetometer measurement
 206:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         recipNorm = invSqrt(mx * mx + my * my + mz * mz);
 895              		.loc 1 206 0
 896 0140 6DEE0D7A 		vmul.f32	s15, s26, s26
 897              	.LVL129:
 898 0144 2CEE0C0A 		vmul.f32	s0, s24, s24
 899              	.LVL130:
 900 0148 77EE807A 		vadd.f32	s15, s15, s0
 901 014c 2CEEAC0A 		vmul.f32	s0, s25, s25
 902 0150 37EE800A 		vadd.f32	s0, s15, s0
 903 0154 FFF7FEFF 		bl	invSqrt
 904              	.LVL131:
 207:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         mx *= recipNorm;
 905              		.loc 1 207 0
 906 0158 2DEE00DA 		vmul.f32	s26, s26, s0
 907              	.LVL132:
 208:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         my *= recipNorm;
 908              		.loc 1 208 0
 909 015c 2CEE00CA 		vmul.f32	s24, s24, s0
 910              	.LVL133:
 209:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         mz *= recipNorm;
 911              		.loc 1 209 0
 912 0160 6CEE80CA 		vmul.f32	s25, s25, s0
 913              	.LVL134:
 210:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 211:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         // Auxiliary variables to avoid repeated arithmetic
 212:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q0mx = 2.0f * q0 * mx;
 914              		.loc 1 212 0
 915 0164 3BEEAB9A 		vadd.f32	s18, s23, s23
 916 0168 6DEE098A 		vmul.f32	s17, s26, s18
 917              	.LVL135:
 213:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q0my = 2.0f * q0 * my;
 918              		.loc 1 213 0
 919 016c 6CEE09FA 		vmul.f32	s31, s24, s18
 920              	.LVL136:
 214:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q0mz = 2.0f * q0 * mz;
 921              		.loc 1 214 0
 922 0170 6CEE896A 		vmul.f32	s13, s25, s18
 923              	.LVL137:
 215:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q1mx = 2.0f * q1 * mx;
 924              		.loc 1 215 0
 925 0174 3AEEAAAA 		vadd.f32	s20, s21, s21
 926 0178 2DEE0AFA 		vmul.f32	s30, s26, s20
 927              	.LVL138:
 216:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q0 = 2.0f * q0;
 217:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q1 = 2.0f * q1;
 218:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q2 = 2.0f * q2;
 928              		.loc 1 218 0
 929 017c 79EEA97A 		vadd.f32	s15, s19, s19
 219:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q3 = 2.0f * q3;
 220:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q0q2 = 2.0f * q0 * q2;
 930              		.loc 1 220 0
 931 0180 69EE895A 		vmul.f32	s11, s19, s18
ARM GAS  /tmp/cc757XYJ.s 			page 21


 932 0184 CDED0A5A 		vstr.32	s11, [sp, #40]
 933              	.LVL139:
 221:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2q2q3 = 2.0f * q2 * q3;
 934              		.loc 1 221 0
 935 0188 F0EE675A 		vmov.f32	s11, s15
 936              	.LVL140:
 937 018c 28EE275A 		vmul.f32	s10, s16, s15
 938 0190 8DED0B5A 		vstr.32	s10, [sp, #44]
 939              	.LVL141:
 222:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q0q0 = q0 * q0;
 940              		.loc 1 222 0
 941 0194 2BEEABEA 		vmul.f32	s28, s23, s23
 223:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q0q1 = q0 * q1;
 224:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q0q2 = q0 * q2;
 225:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q0q3 = q0 * q3;
 226:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q1q1 = q1 * q1;
 942              		.loc 1 226 0
 943 0198 2AEEAABA 		vmul.f32	s22, s21, s21
 944              	.LVL142:
 227:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q1q2 = q1 * q2;
 228:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q1q3 = q1 * q3;
 229:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q2q2 = q2 * q2;
 945              		.loc 1 229 0
 946 019c 69EEA9DA 		vmul.f32	s27, s19, s19
 947              	.LVL143:
 230:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q2q3 = q2 * q3;
 231:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         q3q3 = q3 * q3;
 948              		.loc 1 231 0
 949 01a0 68EE08EA 		vmul.f32	s29, s16, s16
 232:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 233:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         // Reference direction of Earth's magnetic field
 234:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         hx = mx * q0q0 - _2q0my * q3 + _2q0mz * q2 + mx * q1q1 + _2q1 * my * q2 + _2q1 * mz * q3 - 
 950              		.loc 1 234 0
 951 01a4 2DEE0E7A 		vmul.f32	s14, s26, s28
 952 01a8 68EE2F7A 		vmul.f32	s15, s16, s31
 953 01ac 37EE677A 		vsub.f32	s14, s14, s15
 954 01b0 69EEA67A 		vmul.f32	s15, s19, s13
 955 01b4 37EE277A 		vadd.f32	s14, s14, s15
 956 01b8 6DEE0B7A 		vmul.f32	s15, s26, s22
 957 01bc 37EE277A 		vadd.f32	s14, s14, s15
 958 01c0 6CEE0A7A 		vmul.f32	s15, s24, s20
 959 01c4 69EEA77A 		vmul.f32	s15, s19, s15
 960 01c8 37EE277A 		vadd.f32	s14, s14, s15
 961 01cc 6CEE8A7A 		vmul.f32	s15, s25, s20
 962 01d0 68EE277A 		vmul.f32	s15, s16, s15
 963 01d4 37EE277A 		vadd.f32	s14, s14, s15
 964 01d8 6DEE2D7A 		vmul.f32	s15, s26, s27
 965 01dc 37EE677A 		vsub.f32	s14, s14, s15
 966 01e0 6DEE2E7A 		vmul.f32	s15, s26, s29
 967 01e4 37EE677A 		vsub.f32	s14, s14, s15
 968              	.LVL144:
 235:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         hy = _2q0mx * q3 + my * q0q0 - _2q0mz * q1 + _2q1mx * q2 - my * q1q1 + my * q2q2 + _2q2 * m
 969              		.loc 1 235 0
 970 01e8 68EE287A 		vmul.f32	s15, s16, s17
 971 01ec 2CEE0E6A 		vmul.f32	s12, s24, s28
 972 01f0 77EE867A 		vadd.f32	s15, s15, s12
 973 01f4 6AEEA66A 		vmul.f32	s13, s21, s13
ARM GAS  /tmp/cc757XYJ.s 			page 22


 974              	.LVL145:
 975 01f8 77EEE67A 		vsub.f32	s15, s15, s13
 976 01fc 69EE8F6A 		vmul.f32	s13, s19, s30
 977 0200 77EEA67A 		vadd.f32	s15, s15, s13
 978 0204 6CEE0B6A 		vmul.f32	s13, s24, s22
 979 0208 77EEE67A 		vsub.f32	s15, s15, s13
 980 020c 6CEE2D6A 		vmul.f32	s13, s24, s27
 981 0210 77EEA67A 		vadd.f32	s15, s15, s13
 982 0214 CDED095A 		vstr.32	s11, [sp, #36]
 983 0218 6CEEA56A 		vmul.f32	s13, s25, s11
 984 021c 68EE266A 		vmul.f32	s13, s16, s13
 985 0220 77EEA67A 		vadd.f32	s15, s15, s13
 986 0224 6CEE2E6A 		vmul.f32	s13, s24, s29
 987 0228 77EEE67A 		vsub.f32	s15, s15, s13
 988              	.LVL146:
 236:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2bx = sqrt(hx * hx + hy * hy);
 989              		.loc 1 236 0
 990 022c 27EE077A 		vmul.f32	s14, s14, s14
 991              	.LVL147:
 992 0230 67EEA77A 		vmul.f32	s15, s15, s15
 993              	.LVL148:
 994 0234 37EE274A 		vadd.f32	s8, s14, s15
 995 0238 14EE100A 		vmov	r0, s8
 996 023c FFF7FEFF 		bl	__aeabi_f2d
 997              	.LVL149:
 998 0240 41EC100B 		vmov	d0, r0, r1
 999 0244 FFF7FEFF 		bl	sqrt
 1000              	.LVL150:
 1001 0248 51EC100B 		vmov	r0, r1, d0
 1002 024c FFF7FEFF 		bl	__aeabi_d2f
 1003              	.LVL151:
 1004 0250 06EE900A 		vmov	s13, r0
 1005              	.LVL152:
 237:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _2bz = -_2q0mx * q2 + _2q0my * q1 + mz * q0q0 + _2q1mx * q3 - mz * q1q1 + _2q2 * my * q3 - 
 1006              		.loc 1 237 0
 1007 0254 68EEE97A 		vnmul.f32	s15, s17, s19
 1008 0258 6AEEAFFA 		vmul.f32	s31, s21, s31
 1009              	.LVL153:
 1010 025c 77EEAF7A 		vadd.f32	s15, s15, s31
 1011 0260 2CEE8EEA 		vmul.f32	s28, s25, s28
 1012              	.LVL154:
 1013 0264 77EE8E7A 		vadd.f32	s15, s15, s28
 1014 0268 28EE0FFA 		vmul.f32	s30, s16, s30
 1015              	.LVL155:
 1016 026c 77EE8F7A 		vadd.f32	s15, s15, s30
 1017 0270 2CEE8BFA 		vmul.f32	s30, s25, s22
 1018 0274 77EECF7A 		vsub.f32	s15, s15, s30
 1019 0278 9DED09EA 		vldr.32	s28, [sp, #36]
 1020 027c 2CEE0E7A 		vmul.f32	s14, s24, s28
 1021 0280 28EE077A 		vmul.f32	s14, s16, s14
 1022 0284 77EE877A 		vadd.f32	s15, s15, s14
 1023 0288 2CEEAD7A 		vmul.f32	s14, s25, s27
 1024 028c 77EEC77A 		vsub.f32	s15, s15, s14
 1025 0290 2CEEAE7A 		vmul.f32	s14, s25, s29
 1026 0294 77EE877A 		vadd.f32	s15, s15, s14
 1027              	.LVL156:
 238:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _4bx = 2.0f * _2bx;
ARM GAS  /tmp/cc757XYJ.s 			page 23


 1028              		.loc 1 238 0
 1029 0298 76EEA6FA 		vadd.f32	s31, s13, s13
 1030              	.LVL157:
 239:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         _4bz = 2.0f * _2bz;
 1031              		.loc 1 239 0
 1032 029c 77EEA71A 		vadd.f32	s3, s15, s15
 1033              	.LVL158:
 240:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 241:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         // Gradient decent algorithm corrective step
 242:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s0 = -_2q2 * (2.0f * q1q3 - _2q0q2 - ax) + _2q1 * (2.0f * q0q1 + _2q2q3 - ay) - _2bz * q2 *
 1034              		.loc 1 242 0
 1035 02a0 2AEE881A 		vmul.f32	s2, s21, s16
 1036 02a4 31EE015A 		vadd.f32	s10, s2, s2
 1037 02a8 DDED0A5A 		vldr.32	s11, [sp, #40]
 1038 02ac 35EE655A 		vsub.f32	s10, s10, s11
 1039 02b0 9DED067A 		vldr.32	s14, [sp, #24]
 1040 02b4 35EE475A 		vsub.f32	s10, s10, s14
 1041 02b8 6EEE450A 		vnmul.f32	s1, s28, s10
 1042 02bc 6BEEAA3A 		vmul.f32	s7, s23, s21
 1043 02c0 73EEA35A 		vadd.f32	s11, s7, s7
 1044 02c4 DDED0B4A 		vldr.32	s9, [sp, #44]
 1045 02c8 74EEA55A 		vadd.f32	s11, s9, s11
 1046 02cc 9DED077A 		vldr.32	s14, [sp, #28]
 1047 02d0 75EEC75A 		vsub.f32	s11, s11, s14
 1048 02d4 2AEE257A 		vmul.f32	s14, s20, s11
 1049 02d8 70EE870A 		vadd.f32	s1, s1, s14
 1050 02dc 29EEA73A 		vmul.f32	s6, s19, s15
 1051 02e0 F6EE004A 		vmov.f32	s9, #5.0e-1
 1052 02e4 34EEED7A 		vsub.f32	s14, s9, s27
 1053 02e8 37EE6E7A 		vsub.f32	s14, s14, s29
 1054 02ec 26EE877A 		vmul.f32	s14, s13, s14
 1055 02f0 2BEEA96A 		vmul.f32	s12, s23, s19
 1056 02f4 71EE46EA 		vsub.f32	s29, s2, s12
 1057              	.LVL159:
 1058 02f8 67EEAEEA 		vmul.f32	s29, s15, s29
 1059 02fc 37EE2E7A 		vadd.f32	s14, s14, s29
 1060 0300 37EE4DDA 		vsub.f32	s26, s14, s26
 1061              	.LVL160:
 1062 0304 63EE0DEA 		vmul.f32	s29, s6, s26
 1063 0308 70EEEE0A 		vsub.f32	s1, s1, s29
 1064 030c F1EE662A 		vneg.f32	s5, s13
 1065 0310 28EE224A 		vmul.f32	s8, s16, s5
 1066 0314 2AEEA72A 		vmul.f32	s4, s21, s15
 1067 0318 34EE024A 		vadd.f32	s8, s8, s4
 1068 031c 2BEE880A 		vmul.f32	s0, s23, s16
 1069 0320 2AEEA97A 		vmul.f32	s14, s21, s19
 1070 0324 37EE407A 		vsub.f32	s14, s14, s0
 1071 0328 26EE877A 		vmul.f32	s14, s13, s14
 1072 032c 29EE880A 		vmul.f32	s0, s19, s16
 1073 0330 73EE803A 		vadd.f32	s7, s7, s0
 1074 0334 67EEA33A 		vmul.f32	s7, s15, s7
 1075 0338 37EE237A 		vadd.f32	s14, s14, s7
 1076 033c 37EE4CCA 		vsub.f32	s24, s14, s24
 1077              	.LVL161:
 1078 0340 64EE0CEA 		vmul.f32	s29, s8, s24
 1079 0344 70EEAE0A 		vadd.f32	s1, s1, s29
 1080 0348 29EEA67A 		vmul.f32	s14, s19, s13
ARM GAS  /tmp/cc757XYJ.s 			page 24


 1081 034c 36EE016A 		vadd.f32	s12, s12, s2
 1082 0350 26EE866A 		vmul.f32	s12, s13, s12
 1083 0354 74EECB4A 		vsub.f32	s9, s9, s22
 1084 0358 74EEED4A 		vsub.f32	s9, s9, s27
 1085 035c 67EEA44A 		vmul.f32	s9, s15, s9
 1086 0360 36EE246A 		vadd.f32	s12, s12, s9
 1087 0364 76EE6CCA 		vsub.f32	s25, s12, s25
 1088              	.LVL162:
 1089 0368 67EE2CEA 		vmul.f32	s29, s14, s25
 1090 036c 70EEAEEA 		vadd.f32	s29, s1, s29
 1091              	.LVL163:
 243:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s1 = _2q3 * (2.0f * q1q3 - _2q0q2 - ax) + _2q0 * (2.0f * q0q1 + _2q2q3 - ay) - 4.0f * q1 * 
 1092              		.loc 1 243 0
 1093 0370 38EE084A 		vadd.f32	s8, s16, s16
 1094 0374 64EE053A 		vmul.f32	s7, s8, s10
 1095 0378 29EE256A 		vmul.f32	s12, s18, s11
 1096 037c 73EE863A 		vadd.f32	s7, s7, s12
 1097 0380 F1EE004A 		vmov.f32	s9, #4.0e+0
 1098 0384 2AEEA46A 		vmul.f32	s12, s21, s9
 1099 0388 3BEE0BBA 		vadd.f32	s22, s22, s22
 1100              	.LVL164:
 1101 038c B7EE001A 		vmov.f32	s2, #1.0e+0
 1102 0390 31EE4BBA 		vsub.f32	s22, s2, s22
 1103 0394 7DEEADDA 		vadd.f32	s27, s27, s27
 1104              	.LVL165:
 1105 0398 3BEE6DBA 		vsub.f32	s22, s22, s27
 1106 039c 9DED081A 		vldr.32	s2, [sp, #32]
 1107 03a0 3BEE41BA 		vsub.f32	s22, s22, s2
 1108 03a4 26EE0B6A 		vmul.f32	s12, s12, s22
 1109 03a8 73EEC63A 		vsub.f32	s7, s7, s12
 1110 03ac 68EE270A 		vmul.f32	s1, s16, s15
 1111 03b0 2DEE20FA 		vmul.f32	s30, s26, s1
 1112 03b4 73EE8F3A 		vadd.f32	s7, s7, s30
 1113 03b8 6BEEA77A 		vmul.f32	s15, s23, s15
 1114              	.LVL166:
 1115 03bc 37EE27FA 		vadd.f32	s30, s14, s15
 1116 03c0 2CEE0FFA 		vmul.f32	s30, s24, s30
 1117 03c4 33EE8FFA 		vadd.f32	s30, s7, s30
 1118 03c8 28EE267A 		vmul.f32	s14, s16, s13
 1119 03cc 2AEEA16A 		vmul.f32	s12, s21, s3
 1120 03d0 37EE467A 		vsub.f32	s14, s14, s12
 1121 03d4 2CEE877A 		vmul.f32	s14, s25, s14
 1122 03d8 3FEE07FA 		vadd.f32	s30, s30, s14
 1123              	.LVL167:
 244:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s2 = -_2q0 * (2.0f * q1q3 - _2q0q2 - ax) + _2q3 * (2.0f * q0q1 + _2q2q3 - ay) - 4.0f * q2 *
 1124              		.loc 1 244 0
 1125 03dc 69EE458A 		vnmul.f32	s17, s18, s10
 1126              	.LVL168:
 1127 03e0 24EE254A 		vmul.f32	s8, s8, s11
 1128 03e4 78EE848A 		vadd.f32	s17, s17, s8
 1129 03e8 69EEA44A 		vmul.f32	s9, s19, s9
 1130 03ec 2BEE24BA 		vmul.f32	s22, s22, s9
 1131 03f0 78EECB8A 		vsub.f32	s17, s17, s22
 1132 03f4 F1EE6FFA 		vneg.f32	s31, s31
 1133              	.LVL169:
 1134 03f8 29EEAF7A 		vmul.f32	s14, s19, s31
 1135 03fc 77EE677A 		vsub.f32	s15, s14, s15
ARM GAS  /tmp/cc757XYJ.s 			page 25


 1136 0400 6DEE277A 		vmul.f32	s15, s26, s15
 1137 0404 78EEA78A 		vadd.f32	s17, s17, s15
 1138 0408 6AEEA67A 		vmul.f32	s15, s21, s13
 1139 040c 70EEA70A 		vadd.f32	s1, s1, s15
 1140 0410 6CEE200A 		vmul.f32	s1, s24, s1
 1141 0414 78EEA08A 		vadd.f32	s17, s17, s1
 1142 0418 6BEEA66A 		vmul.f32	s13, s23, s13
 1143 041c 69EEA11A 		vmul.f32	s3, s19, s3
 1144              	.LVL170:
 1145 0420 76EEE16A 		vsub.f32	s13, s13, s3
 1146 0424 6CEEA66A 		vmul.f32	s13, s25, s13
 1147 0428 78EEA68A 		vadd.f32	s17, s17, s13
 1148              	.LVL171:
 245:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s3 = _2q1 * (2.0f * q1q3 - _2q0q2 - ax) + _2q2 * (2.0f * q0q1 + _2q2q3 - ay) + (-_4bx * q3 
 1149              		.loc 1 245 0
 1150 042c 2AEE05AA 		vmul.f32	s20, s20, s10
 1151              	.LVL172:
 1152 0430 6EEE255A 		vmul.f32	s11, s28, s11
 1153 0434 7AEE255A 		vadd.f32	s11, s20, s11
 1154 0438 68EE2FFA 		vmul.f32	s31, s16, s31
 1155 043c 32EE2F2A 		vadd.f32	s4, s4, s31
 1156 0440 2DEE02DA 		vmul.f32	s26, s26, s4
 1157 0444 35EE8DDA 		vadd.f32	s26, s11, s26
 1158 0448 6BEEA22A 		vmul.f32	s5, s23, s5
 1159 044c 33EE223A 		vadd.f32	s6, s6, s5
 1160 0450 2CEE03CA 		vmul.f32	s24, s24, s6
 1161 0454 3DEE0CCA 		vadd.f32	s24, s26, s24
 1162 0458 6CEEA7CA 		vmul.f32	s25, s25, s15
 1163 045c 7CEE2CCA 		vadd.f32	s25, s24, s25
 1164              	.LVL173:
 246:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         recipNorm = invSqrt(s0 * s0 + s1 * s1 + s2 * s2 + s3 * s3); // normalise step magnitude
 1165              		.loc 1 246 0
 1166 0460 6EEEAE7A 		vmul.f32	s15, s29, s29
 1167 0464 2FEE0F0A 		vmul.f32	s0, s30, s30
 1168 0468 77EE807A 		vadd.f32	s15, s15, s0
 1169 046c 28EEA80A 		vmul.f32	s0, s17, s17
 1170 0470 77EE807A 		vadd.f32	s15, s15, s0
 1171 0474 2CEEAC0A 		vmul.f32	s0, s25, s25
 1172 0478 37EE800A 		vadd.f32	s0, s15, s0
 1173 047c FFF7FEFF 		bl	invSqrt
 1174              	.LVL174:
 247:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s0 *= recipNorm;
 1175              		.loc 1 247 0
 1176 0480 6EEE80EA 		vmul.f32	s29, s29, s0
 1177              	.LVL175:
 248:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s1 *= recipNorm;
 1178              		.loc 1 248 0
 1179 0484 2FEE00FA 		vmul.f32	s30, s30, s0
 1180              	.LVL176:
 249:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s2 *= recipNorm;
 1181              		.loc 1 249 0
 1182 0488 68EE808A 		vmul.f32	s17, s17, s0
 1183              	.LVL177:
 250:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         s3 *= recipNorm;
 1184              		.loc 1 250 0
 1185 048c 6CEE80CA 		vmul.f32	s25, s25, s0
 1186              	.LVL178:
ARM GAS  /tmp/cc757XYJ.s 			page 26


 251:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 252:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         // Apply feedback step
 253:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         qDot1 -= beta * s0;
 1187              		.loc 1 253 0
 1188 0490 DDED057A 		vldr.32	s15, [sp, #20]
 1189 0494 67EEAEEA 		vmul.f32	s29, s15, s29
 1190              	.LVL179:
 1191 0498 9DED007A 		vldr.32	s14, [sp]
 1192 049c 37EE6E7A 		vsub.f32	s14, s14, s29
 1193 04a0 8DED007A 		vstr.32	s14, [sp]
 1194              	.LVL180:
 254:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         qDot2 -= beta * s1;
 1195              		.loc 1 254 0
 1196 04a4 27EE8FFA 		vmul.f32	s30, s15, s30
 1197              	.LVL181:
 1198 04a8 9DED017A 		vldr.32	s14, [sp, #4]
 1199              	.LVL182:
 1200 04ac 37EE4F7A 		vsub.f32	s14, s14, s30
 1201 04b0 8DED017A 		vstr.32	s14, [sp, #4]
 1202              	.LVL183:
 255:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         qDot3 -= beta * s2;
 1203              		.loc 1 255 0
 1204 04b4 67EEA88A 		vmul.f32	s17, s15, s17
 1205              	.LVL184:
 1206 04b8 9DED027A 		vldr.32	s14, [sp, #8]
 1207              	.LVL185:
 1208 04bc 37EE687A 		vsub.f32	s14, s14, s17
 1209 04c0 8DED027A 		vstr.32	s14, [sp, #8]
 1210              	.LVL186:
 256:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         qDot4 -= beta * s3;
 1211              		.loc 1 256 0
 1212 04c4 67EEACCA 		vmul.f32	s25, s15, s25
 1213              	.LVL187:
 1214 04c8 DDED037A 		vldr.32	s15, [sp, #12]
 1215 04cc 77EEEC7A 		vsub.f32	s15, s15, s25
 1216 04d0 CDED037A 		vstr.32	s15, [sp, #12]
 1217              	.LVL188:
 1218              	.L32:
 257:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     }
 258:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 259:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     // Integrate rate of change of quaternion to yield quaternion
 260:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q0 += qDot1 * (1.0f / sampleFreq);
 1219              		.loc 1 260 0
 1220 04d4 F7EE007A 		vmov.f32	s15, #1.0e+0
 1221 04d8 9DED047A 		vldr.32	s14, [sp, #16]
 1222 04dc 87EE870A 		vdiv.f32	s0, s15, s14
 1223 04e0 DDED007A 		vldr.32	s15, [sp]
 1224 04e4 67EE807A 		vmul.f32	s15, s15, s0
 1225 04e8 7BEEA7BA 		vadd.f32	s23, s23, s15
 1226              	.LVL189:
 261:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q1 += qDot2 * (1.0f / sampleFreq);
 1227              		.loc 1 261 0
 1228 04ec DDED017A 		vldr.32	s15, [sp, #4]
 1229 04f0 67EE807A 		vmul.f32	s15, s15, s0
 1230 04f4 7AEEA7AA 		vadd.f32	s21, s21, s15
 1231              	.LVL190:
 262:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q2 += qDot3 * (1.0f / sampleFreq);
ARM GAS  /tmp/cc757XYJ.s 			page 27


 1232              		.loc 1 262 0
 1233 04f8 DDED027A 		vldr.32	s15, [sp, #8]
 1234 04fc 67EE807A 		vmul.f32	s15, s15, s0
 1235 0500 79EEA79A 		vadd.f32	s19, s19, s15
 1236              	.LVL191:
 263:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q3 += qDot4 * (1.0f / sampleFreq);
 1237              		.loc 1 263 0
 1238 0504 DDED037A 		vldr.32	s15, [sp, #12]
 1239 0508 27EE800A 		vmul.f32	s0, s15, s0
 1240 050c 38EE008A 		vadd.f32	s16, s16, s0
 1241              	.LVL192:
 264:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 265:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     // Normalise quaternion
 266:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     recipNorm = invSqrt(q0 * q0 + q1 * q1 + q2 * q2 + q3 * q3);
 1242              		.loc 1 266 0
 1243 0510 6BEEAB7A 		vmul.f32	s15, s23, s23
 1244 0514 2AEEAA0A 		vmul.f32	s0, s21, s21
 1245 0518 77EE807A 		vadd.f32	s15, s15, s0
 1246 051c 29EEA90A 		vmul.f32	s0, s19, s19
 1247 0520 77EE807A 		vadd.f32	s15, s15, s0
 1248 0524 28EE080A 		vmul.f32	s0, s16, s16
 1249 0528 37EE800A 		vadd.f32	s0, s15, s0
 1250 052c FFF7FEFF 		bl	invSqrt
 1251              	.LVL193:
 267:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q0 *= recipNorm;
 1252              		.loc 1 267 0
 1253 0530 6BEE80BA 		vmul.f32	s23, s23, s0
 1254              	.LVL194:
 268:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q1 *= recipNorm;
 1255              		.loc 1 268 0
 1256 0534 6AEE80AA 		vmul.f32	s21, s21, s0
 1257              	.LVL195:
 269:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q2 *= recipNorm;
 1258              		.loc 1 269 0
 1259 0538 69EE809A 		vmul.f32	s19, s19, s0
 1260              	.LVL196:
 270:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     q3 *= recipNorm;
 1261              		.loc 1 270 0
 1262 053c 28EE008A 		vmul.f32	s16, s16, s0
 1263              	.LVL197:
 271:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 272:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->q0 = q0;
 1264              		.loc 1 272 0
 1265 0540 C4ED02BA 		vstr.32	s23, [r4, #8]
 273:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->q1 = q1;
 1266              		.loc 1 273 0
 1267 0544 C4ED03AA 		vstr.32	s21, [r4, #12]
 274:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->q2 = q2;
 1268              		.loc 1 274 0
 1269 0548 C4ED049A 		vstr.32	s19, [r4, #16]
 275:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     handle->q3 = q3;
 1270              		.loc 1 275 0
 1271 054c 84ED058A 		vstr.32	s16, [r4, #20]
 276:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** 
 277:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****     mutex_unlock(handle->lock);
 1272              		.loc 1 277 0
 1273 0550 0023     		movs	r3, #0
ARM GAS  /tmp/cc757XYJ.s 			page 28


 1274 0552 1A46     		mov	r2, r3
 1275 0554 1946     		mov	r1, r3
 1276 0556 A069     		ldr	r0, [r4, #24]
 1277 0558 FFF7FEFF 		bl	xQueueGenericSend
 1278              	.LVL198:
 1279              	.L27:
 278:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c **** }...
 1280              		.loc 1 278 0
 1281 055c 0CB0     		add	sp, sp, #48
 1282              	.LCFI17:
 1283              		.cfi_remember_state
 1284              		.cfi_def_cfa_offset 72
 1285              		@ sp needed
 1286 055e BDEC108B 		vldm	sp!, {d8-d15}
 1287              	.LCFI18:
 1288              		.cfi_restore 94
 1289              		.cfi_restore 95
 1290              		.cfi_restore 92
 1291              		.cfi_restore 93
 1292              		.cfi_restore 90
 1293              		.cfi_restore 91
 1294              		.cfi_restore 88
 1295              		.cfi_restore 89
 1296              		.cfi_restore 86
 1297              		.cfi_restore 87
 1298              		.cfi_restore 84
 1299              		.cfi_restore 85
 1300              		.cfi_restore 82
 1301              		.cfi_restore 83
 1302              		.cfi_restore 80
 1303              		.cfi_restore 81
 1304              		.cfi_def_cfa_offset 8
 1305              	.LVL199:
 1306 0562 10BD     		pop	{r4, pc}
 1307              	.LVL200:
 1308              	.L34:
 1309              	.LCFI19:
 1310              		.cfi_restore_state
 186:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         madgwick_update_6dof(handle, gx, gy, gz, ax, ay, az);
 1311              		.loc 1 186 0
 1312 0564 F0EE4E2A 		vmov.f32	s5, s28
 1313 0568 B0EE6D2A 		vmov.f32	s4, s27
 1314 056c F0EE4B1A 		vmov.f32	s3, s22
 1315 0570 B0EE681A 		vmov.f32	s2, s17
 1316 0574 F0EE4A0A 		vmov.f32	s1, s20
 1317 0578 B0EE490A 		vmov.f32	s0, s18
 1318 057c 2046     		mov	r0, r4
 1319 057e FFF7FEFF 		bl	madgwick_update_6dof
 1320              	.LVL201:
 187:/home/phong/Documents/thesis/stm32f4/components/imu/madgwick.c ****         return;
 1321              		.loc 1 187 0
 1322 0582 EBE7     		b	.L27
 1323              		.cfi_endproc
 1324              	.LFE11:
 1326              		.section	.rodata.__FUNCTION__.7011,"a",%progbits
 1327              		.align	2
 1328              		.set	.LANCHOR0,. + 0
ARM GAS  /tmp/cc757XYJ.s 			page 29


 1331              	__FUNCTION__.7011:
 1332 0000 6D616467 		.ascii	"madgwick_config\000"
 1332      7769636B 
 1332      5F636F6E 
 1332      66696700 
 1333              		.section	.rodata.madgwick_config.str1.4,"aMS",%progbits,1
 1334              		.align	2
 1335              	.LC0:
 1336 0000 1B5B303B 		.ascii	"\033[0;31mE (%d) %s: %s:%d (%s):%s\033[0m\015\012\000"
 1336      33316D45 
 1336      20282564 
 1336      29202573 
 1336      3A202573 
 1337 0026 0000     		.space	2
 1338              	.LC1:
 1339 0028 4D414447 		.ascii	"MADGWICK AHRS\000"
 1339      5749434B 
 1339      20414852 
 1339      5300
 1340 0036 0000     		.space	2
 1341              	.LC2:
 1342 0038 4D616467 		.ascii	"Madgwick AHRS init error\000"
 1342      7769636B 
 1342      20414852 
 1342      5320696E 
 1342      69742065 
 1343 0051 000000   		.space	3
 1344              	.LC3:
 1345 0054 2F686F6D 		.ascii	"/home/phong/Documents/thesis/stm32f4/components/imu"
 1345      652F7068 
 1345      6F6E672F 
 1345      446F6375 
 1345      6D656E74 
 1346 0087 2F6D6164 		.ascii	"/madgwick.c\000"
 1346      67776963 
 1346      6B2E6300 
 1347              		.text
 1348              	.Letext0:
 1349              		.file 2 "/home/phong/Documents/thesis/stm32f4/stm-idf/components/newlib/include/machine/_default_t
 1350              		.file 3 "/home/phong/Documents/thesis/stm32f4/stm-idf/components/newlib/include/sys/_stdint.h"
 1351              		.file 4 "/home/phong/Documents/thesis/stm32f4/stm-idf/components/newlib/include/sys/lock.h"
 1352              		.file 5 "/home/phong/Documents/thesis/stm32f4/stm-idf/components/newlib/include/sys/_types.h"
 1353              		.file 6 "/usr/lib/gcc/arm-none-eabi/6.3.1/include/stddef.h"
 1354              		.file 7 "/home/phong/Documents/thesis/stm32f4/stm-idf/components/newlib/include/sys/reent.h"
 1355              		.file 8 "/home/phong/Documents/thesis/stm32f4/stm-idf/components/newlib/include/math.h"
 1356              		.file 9 "/home/phong/Documents/thesis/stm32f4/stm-idf/components/freertos/include/freertos/FreeRTO
 1357              		.file 10 "/home/phong/Documents/thesis/stm32f4/stm-idf/components/freertos/portable/gcc/arm_cm4f/p
 1358              		.file 11 "/home/phong/Documents/thesis/stm32f4/stm-idf/components/freertos/include/freertos/queue.
 1359              		.file 12 "/home/phong/Documents/thesis/stm32f4/stm-idf/components/freertos/include/freertos/semphr
 1360              		.file 13 "/home/phong/Documents/thesis/stm32f4/stm-idf/components/newlib/include/stdlib.h"
 1361              		.file 14 "/home/phong/Documents/thesis/stm32f4/components/imu/include/imu.h"
 1362              		.file 15 "/home/phong/Documents/thesis/stm32f4/components/imu/include/madgwick.h"
 1363              		.file 16 "/home/phong/Documents/thesis/stm32f4/stm-idf/components/log/include/stm_log.h"
ARM GAS  /tmp/cc757XYJ.s 			page 30


DEFINED SYMBOLS
                            *ABS*:0000000000000000 madgwick.c
     /tmp/cc757XYJ.s:18     .text.invSqrt:0000000000000000 $t
     /tmp/cc757XYJ.s:24     .text.invSqrt:0000000000000000 invSqrt
     /tmp/cc757XYJ.s:60     .text.invSqrt:000000000000002c $d
     /tmp/cc757XYJ.s:65     .text.madgwick_config:0000000000000000 $t
     /tmp/cc757XYJ.s:72     .text.madgwick_config:0000000000000000 madgwick_config
     /tmp/cc757XYJ.s:180    .text.madgwick_config:0000000000000084 $d
     /tmp/cc757XYJ.s:189    .text.madgwick_set_beta:0000000000000000 $t
     /tmp/cc757XYJ.s:196    .text.madgwick_set_beta:0000000000000000 madgwick_set_beta
     /tmp/cc757XYJ.s:245    .text.madgwick_set_sample_frequency:0000000000000000 $t
     /tmp/cc757XYJ.s:252    .text.madgwick_set_sample_frequency:0000000000000000 madgwick_set_sample_frequency
     /tmp/cc757XYJ.s:301    .text.madgwick_get_quaternion:0000000000000000 $t
     /tmp/cc757XYJ.s:308    .text.madgwick_get_quaternion:0000000000000000 madgwick_get_quaternion
     /tmp/cc757XYJ.s:357    .text.madgwick_update_6dof:0000000000000000 $t
     /tmp/cc757XYJ.s:364    .text.madgwick_update_6dof:0000000000000000 madgwick_update_6dof
     /tmp/cc757XYJ.s:723    .text.madgwick_update_9dof:0000000000000000 $t
     /tmp/cc757XYJ.s:730    .text.madgwick_update_9dof:0000000000000000 madgwick_update_9dof
     /tmp/cc757XYJ.s:1327   .rodata.__FUNCTION__.7011:0000000000000000 $d
     /tmp/cc757XYJ.s:1331   .rodata.__FUNCTION__.7011:0000000000000000 __FUNCTION__.7011
     /tmp/cc757XYJ.s:1334   .rodata.madgwick_config.str1.4:0000000000000000 $d
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
calloc
xQueueCreateMutex
stm_log_timestamp
stm_log_write
xQueueSemaphoreTake
xQueueGenericSend
__aeabi_f2d
__aeabi_d2f
sqrt
